<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=0"
    />
    <title>Maintenance - Operations Hub</title>

    <!-- Favicon -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="../assets/img/favicon.png"
    />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css" />

    <!-- Feather CSS -->
    <link rel="stylesheet" href="../assets/plugins/icons/feather/feather.css" />

    <!-- Tabler Icons -->
    <link
      rel="stylesheet"
      href="../assets/plugins/tabler-icons/tabler-icons.min.css"
    />

    <!-- Fontawesome -->
    <link
      rel="stylesheet"
      href="../assets/plugins/fontawesome/css/all.min.css"
    />

    <!-- Main CSS -->
    <link rel="stylesheet" href="../assets/css/style.css" />
  </head>
  <style>
    /* Fix sidebar scroll */
    .sidebar-inner {
      overflow-y: auto !important;
      height: calc(100vh - 60px) !important;
    }
    .sidebar-menu ul li a.active {
      background: #f5f5f5 !important;
      color: #333 !important;
    }

    .sidebar-menu ul li a:hover {
      background: #f0f0f0 !important;
      color: #333 !important;
    }

    body.mini-sidebar .sidebar {
      width: 60px !important;
    }

    body.mini-sidebar .sidebar .sidebar-menu span {
      display: none !important;
    }

    body.mini-sidebar .sidebar .sidebar-menu i {
      margin-right: 0 !important;
    }

    /* Card-style background for the whole tab bar */
    #taskTabs {
      background: #f5f7fa; /* light card background */
      padding: 8px 10px;
      border-radius: 10px;
      display: inline-flex;
      gap: 8px;
      border: 1px solid #e3e6eb;
    }

    /* Individual tabs */
    #taskTabs .nav-link {
      border-radius: 8px;
      color: #444;
      font-weight: 500;
      padding: 8px 14px;
      border: none;
      background: transparent;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Active tab (white card look) */
    #taskTabs .nav-link.active {
      background: #ffffff;
      color: #000;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
    }

    /* Hover effect */
    #taskTabs .nav-link:hover {
      background: #ffffff;
    }

    /* Hide dots initially */
    .header-menu-btn {
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s;
      border: none;
      background: #f3f4f6;
      padding: 4px 6px;
      border-radius: 6px;
      display: flex;
      align-items: center;
    }

    .table-th:hover .header-menu-btn {
      opacity: 1;
      visibility: visible;
    }

    .header-dropdown {
      position: absolute;
      top: 110%;
      right: 0;
      width: 170px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
      padding: 6px 0;
      z-index: 9999;
    }

    .header-dropdown .dropdown-item {
      padding: 8px 14px;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .header-dropdown .dropdown-item:hover {
      background: #f3f4f6;
    }

    .kanban-header-box {
      border-radius: 12px;
      padding: 14px 18px;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .kanban-count {
      background: #fff;
      padding: 3px 10px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
    }

    .kanban-column {
      padding: 10px;
      border-radius: 12px;
      background: transparent;
    }

    .kanban-card-container {
      background: #ffffff;
      border-radius: 12px;
      padding: 18px;
      border: none;
      box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
      margin-bottom: 16px;
    }

    /* CATEGORY LABELS */
    .cat1 {
      background: #fde1e1;
      color: #c64a4a;
    }
    .cat2 {
      background: #fff5c7;
      color: #b38a00;
    }
    .cat3 {
      background: #dbffe7;
      color: #2e7d32;
    }

    .cat-pill {
      display: inline-block;
      padding: 4px 14px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .metric-card {
      background: #fff;
      border-radius: 16px;
      padding: 22px 24px;
      border: 1px solid #e5e5e5;
      transition: 0.2s ease;
    }

    .metric-card:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }

    .metric-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .metric-number {
      font-size: 26px;
      font-weight: 700;
      color: #1c1c1c;
    }

    .metric-icon {
      font-size: 32px;
      opacity: 0.9;
    }

    .metric-title {
      margin-top: 8px;
      font-size: 15px;
      font-weight: 600;
      color: #445;
    }

    .metric-previous {
      margin-top: 4px;
      font-size: 13px;
      color: #999;
    }
    /* Dots stay same */
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      display: inline-block;
    }

    .dot-red {
      background-color: #ff4d4f;
    }
    .dot-yellow {
      background-color: #f6c23e;
    }
    .dot-green {
      background-color: #1cc88a;
    }
    .dot-gray {
      background-color: #6c757d;
    }
    .dot-blue {
      background-color: #4e73df;
    }
    .dot-purple {
      background-color: #9b51e0;
    }

    /* ✅ EXACT PLAIN GREY BAR LIKE YOUR 2ND IMAGE */
    .progress-custom {
      width: 180px;
      height: 8px;
      border-radius: 10px;
      background-color: #e5e7eb; /* light grey */
      overflow: hidden;
    }

    /* ✅ KILLS BOOTSTRAP ORANGE COMPLETELY */
    .bar-grey {
      background-color: #e5e7eb !important; /* SAME as container */
      width: 100% !important; /* FULL BAR ALWAYS */
      height: 100%;
      border-radius: 10px;
    }

    /* ✅ EXTRA SAFETY: remove Bootstrap fill effect */
    .progress-bar {
      background-image: none !important;
      box-shadow: none !important;
    }

    /* ✅ Force both cards to same height */
    .equal-height-card {
      min-height: 240px; /* adjust if needed */
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    /* ✅ Vertical spacing inside cards like reference */
    .equal-height-card .d-flex {
      margin-bottom: 16px;
    }

    .equal-height-card .d-flex:last-child {
      margin-bottom: 0;
    }
    .priority-breakdown-card {
      height: 320px;
      display: flex;
      flex-direction: column;
    }

    .chart-placeholder {
      flex: 1; /* takes full empty space */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .priority-legend {
      display: flex;
      justify-content: center;
      gap: 20px;
      font-size: 14px;
      margin-top: 10px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .legend-box {
      width: 14px;
      height: 10px;
      border-radius: 2px;
      display: inline-block;
    }

    .legend-box.red {
      background-color: #ff4d4f;
    }

    .legend-box.yellow {
      background-color: #f6c23e;
    }

    .legend-box.green {
      background-color: #1cc88a;
    }

    /* Widget dashboard */
    .widget-placeholder {
      background: #f8fafc;
      border: 2px dashed #d1d5db;
      border-radius: 14px;
      padding: 60px 20px;
    }

    .widget-box {
      text-align: center;
      color: #6b7280;
    }

    .widget-icon {
      font-size: 42px;
      color: #9ca3af;
    }
  </style>

  <body>
    <!-- Main Wrapper -->
    <div class="main-wrapper">
      <!-- Header -->
      <div class="header">
        <div class="main-header">
          <div class="header-left">
            <a href="index.html" class="logo">
              <img src="../assets/img/logo.svg" alt="Logo" />
            </a>
            <a href="index.html" class="dark-logo">
              <img src="../assets/img/logo-white.svg" alt="Logo" />
            </a>
          </div>

          <a id="mobile_btn" class="mobile_btn" href="#sidebar">
            <span class="bar-icon">
              <span></span>
              <span></span>
              <span></span>
            </span>
          </a>

          <div class="header-user">
            <div class="nav user-menu nav-list">
              <div class="me-auto d-flex align-items-center" id="header-search">
                <a
                  id="toggle_btn"
                  href="javascript:void(0);"
                  class="btn btn-menubar me-1"
                >
                  <i class="ti ti-arrow-bar-to-left"></i>
                </a>

                <div class="input-group input-group-flat d-inline-flex me-1">
                  <span class="input-icon-addon">
                    <i class="ti ti-search"></i>
                  </span>
                  <input
                    type="text"
                    class="form-control"
                    placeholder="Search in HRMS"
                  />
                  <span class="input-group-text">
                    <kbd>CTRL + /</kbd>
                  </span>
                </div>

                <a href="profile-settings.html" class="btn btn-menubar">
                  <i class="ti ti-settings-cog"></i>
                </a>
              </div>

              <div class="d-flex align-items-center">
                <a href="#" class="btn btn-menubar btnFullscreen">
                  <i class="ti ti-maximize"></i>
                </a>
                <a href="chat.html" class="btn btn-menubar position-relative">
                  <i class="ti ti-brand-hipchat"></i>
                  <span class="badge bg-info rounded-pill header-badge">5</span>
                </a>
                <a href="email.html" class="btn btn-menubar">
                  <i class="ti ti-mail"></i>
                </a>

                <div class="dropdown profile-dropdown">
                  <a
                    href="#"
                    class="dropdown-toggle d-flex align-items-center"
                    data-bs-toggle="dropdown"
                  >
                    <span class="avatar avatar-sm online">
                      <img
                        src="../assets/img/profiles/avatar-12.jpg"
                        class="rounded-circle"
                        alt=""
                      />
                    </span>
                  </a>
                  <div class="dropdown-menu shadow-none">
                    <a class="dropdown-item" href="profile.html">My Profile</a>
                    <a class="dropdown-item" href="profile-settings.html"
                      >Settings</a
                    >
                    <a class="dropdown-item" href="login.html">Logout</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- /Header -->

      <!-- Sidebar -->
      <div class="sidebar" id="sidebar">
        <div class="sidebar-logo">
          <a href="index.html" class="logo logo-normal">
            <img src="../assets/img/logo.svg" alt="Logo" />
          </a>
          <a href="index.html" class="logo-small">
            <img src="../assets/img/logo-small.svg" alt="Logo" />
          </a>
        </div>

        <div class="sidebar-inner slimscroll">
          <div id="sidebar-menu" class="sidebar-menu">
            <ul>
              <li class="menu-title">
                <span>MAIN</span>
              </li>

              <li>
                <a href="index.html">
                  <i class="ti ti-smart-home"></i>
                  <span>Dashboard</span>
                </a>
              </li>

              <li class="menu-title">
                <span>HOTELS</span>
              </li>
              <li>
                <a href="hotels.html">
                  <i class="ti ti-building"></i>
                  <span>Hotels</span>
                </a>
              </li>
              <li>
                <a href="hoteldetails.html">
                  <i class="ti ti-building-community"></i>
                  <span>Hotel Details</span>
                </a>
              </li>

              <li class="menu-title">
                <span>CONTACTS</span>
              </li>
              <li>
                <a href="contacts.html">
                  <i class="ti ti-user"></i>
                  <span>Contacts</span>
                </a>
              </li>

              <li class="menu-title">
                <span>OPERATION HUB</span>
              </li>
              <li>
                <a href="maintenance.html">
                  <i class="ti ti-settings"></i>
                  <span>Maintenance</span>
                </a>
              </li>
              <li>
                <a href="compliance.html">
                  <i class="ti ti-user-check"></i>
                  <span>Compliance</span>
                </a>
              </li>
              <li>
                <a href="complaints.html">
                  <i class="ti ti-filter"></i>
                  <span>Complaints</span>
                </a>
              </li>
              <li>
                <a href="airetasks.html">
                  <i class="ti ti-device-analytics"></i>
                  <span>AIRE Tasks</span>
                </a>
              </li>
              <li>
                <a href="litigation.html">
                  <i class="ti ti-briefcase"></i>
                  <span>Litigation</span>
                </a>
              </li>
              <li>
                <a href="safeguarding.html">
                  <i class="ti ti-activity"></i>
                  <span>Safeguarding</span>
                </a>
              </li>
              <li>
                <a href="migranthelp.html">
                  <i class="ti ti-target"></i>
                  <span>Migrant Help</span>
                </a>
              </li>
              <li>
                <a href="employees.html">
                  <i class="ti ti-users"></i>
                  <span>Employees</span>
                </a>
              </li>

              <li class="menu-title">
                <span>Service Users</span>
              </li>
              <li>
                <a href="suprofiles.html">
                  <i class="ti ti-user-circle"></i>
                  <span>SU Profiles</span>
                </a>
              </li>

              <li>
                <a href="demographics.html">
                  <i class="ti ti-heart"></i>
                  <span>Demographics & Health</span>
                </a>
              </li>

              <li>
                <a href="accommodation.html">
                  <i class="ti ti-home"></i>
                  <span>Accommodation History</span>
                </a>
              </li>

              <li>
                <a href="casedocumentation.html">
                  <i class="ti ti-file-description"></i>
                  <span>Case Documents</span>
                </a>
              </li>

              <li class="menu-title">
                <span>INCIDENET MANAGEMENT</span>
              </li>
              <li>
                <a href="incidents.html">
                  <i class="ti ti-alert-circle"></i>
                  <span>Incidents</span>
                </a>
              </li>

              <li>
                <a href="complaintsfromincidents.html">
                  <i class="ti ti-message"></i>
                  <span>Complaints</span>
                </a>
              </li>

              <li>
                <a href="vcsorganisations.html">
                  <i class="ti ti-building"></i>
                  <span>VCS Organisations</span>
                </a>
              </li>

              <li class="menu-title">
                <span>PROJECTS</span>
              </li>
              <li>
                <a href="projects.html">
                  <i class="ti ti-box"></i>
                  <span>Projects</span>
                </a>
              </li>
              <li>
                <a href="tasks.html">
                  <i class="ti ti-list-check"></i>
                  <span>Tasks</span>
                </a>
              </li>
              <li>
                <a href="activities.html">
                  <i class="ti ti-activity"></i>
                  <span>Activities</span>
                </a>
              </li>

              <li class="menu-title">
                <span>REPORTS</span>
              </li>
              <li>
                <a href="employee-report.html">
                  <i class="ti ti-file-analytics"></i>
                  <span>Employee Report</span>
                </a>
              </li>
              <li>
                <a href="user-report.html">
                  <i class="ti ti-report"></i>
                  <span>User Report</span>
                </a>
              </li>
              <li>
                <a href="company-report.html">
                  <i class="ti ti-report-money"></i>
                  <span>Company Report</span>
                </a>
              </li>

              <li class="menu-title">
                <span>PROFILE</span>
              </li>
              <li>
                <a href="profile.html">
                  <i class="ti ti-user-circle"></i>
                  <span>My Profile</span>
                </a>
              </li>
              <li>
                <a href="profile-settings.html">
                  <i class="ti ti-settings"></i>
                  <span>Profile Settings</span>
                </a>
              </li>

              <li class="menu-title">
                <span>AUTH</span>
              </li>
              <li>
                <a href="login.html">
                  <i class="ti ti-login"></i>
                  <span>Login</span>
                </a>
              </li>
              <li>
                <a href="register.html">
                  <i class="ti ti-forms"></i>
                  <span>Register</span>
                </a>
              </li>
              <li>
                <a href="forgot-password.html">
                  <i class="ti ti-lock"></i>
                  <span>Forgot Password</span>
                </a>
              </li>
              <li>
                <a href="reset-password.html">
                  <i class="ti ti-key"></i>
                  <span>Reset Password</span>
                </a>
              </li>
              <li>
                <a href="two-step-verification.html">
                  <i class="ti ti-shield-check"></i>
                  <span>Two-Step Verification</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <!-- /Sidebar -->

      <!-- Page Wrapper -->
      <div class="page-wrapper">
        <div class="content container-fluid">
          <!-- Page Header -->
          <div class="page-header">
            <div class="row align-items-center">
              <div class="col">
                <h3 class="page-title">Operations Hub / Maintenance</h3>
                <ul class="breadcrumb">
                  <li class="breadcrumb-item">Operations Hub</li>
                  <li class="breadcrumb-item active">Maintenance</li>
                </ul>
              </div>
            </div>
          </div>
          <!-- /Page Header -->

          <!-- Stats Cards Row -->
          <div class="row g-3 mb-4">
            <div class="col-xl-3 col-md-6">
              <div class="card card-body">
                <span>Total Tasks</span>
                <h3 class="mt-2">6</h3>
                <p class="text-success">
                  <i class="ti ti-trending-up"></i> 66.7% active
                </p>
              </div>
            </div>

            <div class="col-xl-3 col-md-6">
              <div class="card card-body">
                <span>Overdue</span>
                <h3 class="text-danger mt-2">4</h3>
                <p class="text-danger">
                  <i class="ti ti-alert-triangle"></i> 66.7% of total
                </p>
              </div>
            </div>

            <div class="col-xl-3 col-md-6">
              <div class="card card-body">
                <span>Due This Week</span>
                <h3 class="mt-2">0</h3>
                <p class="text-warning"><i class="ti ti-clock"></i> 0%</p>
              </div>
            </div>

            <div class="col-xl-3 col-md-6">
              <div class="card card-body">
                <span>Completed</span>
                <h3 class="text-success mt-2">2</h3>
                <p class="text-success">
                  <i class="ti ti-check"></i> 33.3% of total
                </p>
              </div>
            </div>
          </div>
          <!-- /Stats Cards Row -->

          <!-- Database + Search -->
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h4 class="mb-0">
              Maintenance Database <span class="text-muted">6 items</span>
            </h4>

            <div class="d-flex gap-2">
              <input
                type="text"
                class="form-control"
                placeholder="Search tasks..."
                style="width: 240px"
              />
              <button class="btn btn-light">
                <i class="ti ti-filter"></i> Filter
              </button>
              <button class="btn btn-light">
                <i class="ti ti-layout-grid"></i> View
              </button>
              <button class="btn btn-success">
                <i class="ti ti-plus"></i> New
              </button>
            </div>
          </div>

          <!-- Tabs -->
          <ul class="nav nav-tabs mb-3" id="taskTabs">
            <li class="nav-item">
              <a class="nav-link active" data-view="table" href="#">
                <i class="ti ti-table me-1"></i> Table
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link" data-view="board" href="#">
                <i class="ti ti-layout-board me-1"></i> Board
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link" data-view="dashboard" href="#">
                <i class="ti ti-chart-bar me-1"></i> Dashboard
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link" data-view="widgets" href="#">
                <i class="ti ti-grid-dots me-1"></i> Widgets
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link" data-view="livebi" href="#">
                <i class="ti ti-trending-up me-1"></i> Live BI
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link" data-view="settings" href="#">
                <i class="ti ti-settings me-1"></i> Settings
              </a>
            </li>
          </ul>

          <!-- Table -->
          <div id="tableView">
            <div class="card">
              <div class="card-body p-0">
                <div class="table-responsive">
                  <table class="table table-hover mb-0">
                    <thead>
                      <tr>
                        <th>
                          <i class="ti ti-file-description me-1"></i> Task Title
                        </th>

                        <!-- Start Date -->
                        <th style="position: relative" class="header-th" data-col="1">
                          <div class="d-flex align-items-center gap-1 th-label">
                            <i class="ti ti-calendar-event me-1"></i>
                            <span>Start Date</span>
                            <i class="ti ti-chevron-down header-arrow"></i>
                            <button
                              class="category-menu-btn"
                              type="button"
                              onclick="toggleGenericMenu(event, this)"
                            >
                              <i class="ti ti-dots"></i>
                            </button>
                          </div>

                          <div class="category-dropdown d-none">
                            <div
                              class="dropdown-item"
                              onclick="toggleGenericSort(this)"
                            >
                              <i class="ti ti-arrows-sort"></i> <span class="sort-label">Sort A → Z</span>
                            </div>
                            <div
                              class="dropdown-item d-flex justify-content-between"
                            >
                              <span><i class="ti ti-filter"></i> Filter</span>
                              <i class="ti ti-chevron-right"></i>
                            </div>
                            <div
                              class="dropdown-item text-danger"
                              onclick="hideGenericColumn(this)"
                            >
                              <i class="ti ti-eye-off"></i> Hide
                            </div>
                          </div>
                        </th>

                        <!-- CATEGORY  -->
                        <th style="position: relative" class="category-th">
                          <div class="d-flex align-items-center gap-1 th-label">
                            <i class="ti ti-tag me-1"></i>
                            <span>Category</span>
                            <i class="ti ti-chevron-down category-arrow"></i>
                            <button
                              class="category-menu-btn"
                              onclick="toggleCategoryMenu(event)"
                              type="button"
                            >
                              <i class="ti ti-dots"></i>
                            </button>
                          </div>

                          <div
                            class="category-dropdown d-none"
                            id="categoryDropdown"
                          >
                            <div
                              class="dropdown-item"
                              onclick="toggleCategorySort()"
                              id="categorySortBtn"
                            >
                              <i class="ti ti-arrows-sort"></i>
                              <span id="sortLabel">Sort A → Z</span>
                            </div>

                            <div
                              class="dropdown-item d-flex justify-content-between align-items-center"
                            >
                              <span><i class="ti ti-filter"></i> Filter</span>
                              <i class="ti ti-chevron-right"></i>
                            </div>

                            <div class="dropdown-item text-danger">
                              <i class="ti ti-eye-off"></i> Hide
                            </div>
                          </div>
                        </th>

                        <!-- Site Name -->
                        <th
                          style="position: relative"
                          class="header-th"
                          data-col="3"
                        >
                          <div class="d-flex align-items-center gap-1 th-label">
                            <i class="ti ti-building me-1"></i>
                            <span>Site Name</span>
                            <i class="ti ti-chevron-down header-arrow"></i>
                            <button
                              class="category-menu-btn"
                              type="button"
                              onclick="toggleGenericMenu(event, this)"
                            >
                              <i class="ti ti-dots"></i>
                            </button>
                          </div>

                          <div class="category-dropdown d-none">
                            <div
                              class="dropdown-item"
                              onclick="toggleGenericSort(this)"
                            >
                              <i class="ti ti-arrows-sort"></i>
                              <span class="sort-label">Sort A → Z</span>
                            </div>
                            <div
                              class="dropdown-item d-flex justify-content-between"
                            >
                              <span><i class="ti ti-filter"></i> Filter</span>
                              <i class="ti ti-chevron-right"></i>
                            </div>
                            <div class="dropdown-item text-danger">
                              <i class="ti ti-eye-off"></i> Hide
                            </div>
                          </div>
                        </th>

                        <!-- Room No -->
                        <th style="position: relative" class="header-th" data-col="4">
                          <div class="d-flex align-items-center gap-1 th-label">
                            <i class="ti ti-home me-1"></i>
                            <span>Room No</span>
                            <i class="ti ti-chevron-down header-arrow"></i>
                            <button
                              class="category-menu-btn"
                              type="button"
                              onclick="toggleGenericMenu(event, this)"
                            >
                              <i class="ti ti-dots"></i>
                            </button>
                          </div>

                          <div class="category-dropdown d-none">
                            <div class="dropdown-item" onclick="toggleGenericSort(this)">
                              <i class="ti ti-arrows-sort"></i> <span class="sort-label">Sort A → Z</span>
                            </div>
                            <div
                              class="dropdown-item d-flex justify-content-between"
                            >
                              <span><i class="ti ti-filter"></i> Filter</span>
                              <i class="ti ti-chevron-right"></i>
                            </div>
                            <div class="dropdown-item text-danger">
                              <i class="ti ti-eye-off"></i> Hide
                            </div>
                          </div>
                        </th>

                        <!-- Raised By -->
                        <th style="position: relative" class="header-th" data-col="5">
                          <div class="d-flex align-items-center gap-1 th-label">
                            <i class="ti ti-user me-1"></i>
                            <span>Raised By</span>
                            <i class="ti ti-chevron-down header-arrow"></i>
                            <button
                              class="category-menu-btn"
                              type="button"
                              onclick="toggleGenericMenu(event, this)"
                            >
                              <i class="ti ti-dots"></i>
                            </button>
                          </div>

                          <div class="category-dropdown d-none">
                            <div class="dropdown-item" onclick="toggleGenericSort(this)">
                              <i class="ti ti-arrows-sort"></i> <span class="sort-label">Sort A → Z</span>
                            </div>
                            <div
                              class="dropdown-item d-flex justify-content-between"
                            >
                              <span><i class="ti ti-filter"></i> Filter</span>
                              <i class="ti ti-chevron-right"></i>
                            </div>
                            <div class="dropdown-item text-danger">
                              <i class="ti ti-eye-off"></i> Hide
                            </div>
                          </div>
                        </th>

                        <!-- Status -->
                        <th style="position: relative" class="header-th" data-col="6">
                          <div class="d-flex align-items-center gap-1 th-label">
                            <i class="ti ti-activity me-1"></i>
                            <span>Status</span>
                            <i class="ti ti-chevron-down header-arrow"></i>
                            <button
                              class="category-menu-btn"
                              type="button"
                              onclick="toggleGenericMenu(event, this)"
                            >
                              <i class="ti ti-dots"></i>
                            </button>
                          </div>

                          <div class="category-dropdown d-none">
                            <div class="dropdown-item" onclick="toggleGenericSort(this)" >
                              
                              <i class="ti ti-arrows-sort"></i> <span class="sort-label">Sort A → Z</span>
                            </div>
                            <div
                              class="dropdown-item d-flex justify-content-between"
                            >
                              <span><i class="ti ti-filter"></i> Filter</span>
                              <i class="ti ti-chevron-right"></i>
                            </div>
                            <div class="dropdown-item text-danger">
                              <i class="ti ti-eye-off"></i> Hide
                            </div>
                          </div>
                        </th>

                        <!-- Action -->
                        <th style="position: relative" class="header-th"  data-col="7">
                          <div class="d-flex align-items-center gap-1 th-label">
                            <i class="ti ti-tool me-1"></i>
                            <span>Action</span>
                            <i class="ti ti-chevron-down header-arrow"></i>
                            <button
                              class="category-menu-btn"
                              type="button"
                              onclick="toggleGenericMenu(event, this)"
                            >
                              <i class="ti ti-dots"></i>
                            </button>
                          </div>

                          <div class="category-dropdown d-none">
                            <div class="dropdown-item" onclick="toggleGenericSort(this)">
                              <i class="ti ti-arrows-sort"></i> <span class="sort-label">Sort A → Z</span>
                            </div>
                            <div
                              class="dropdown-item d-flex justify-content-between"
                            >
                              <span><i class="ti ti-filter"></i> Filter</span>
                              <i class="ti ti-chevron-right"></i>
                            </div>
                            <div class="dropdown-item text-danger">
                              <i class="ti ti-eye-off"></i> Hide
                            </div>
                          </div>
                        </th>

                        <!-- Due Date -->
                        <th style="position: relative" class="header-th" data-col="8">
                          <div class="d-flex align-items-center gap-1 th-label">
                            <i class="ti ti-calendar-time me-1"></i>
                            <span>Due Date</span>
                            <i class="ti ti-chevron-down header-arrow"></i>
                            <button
                              class="category-menu-btn"
                              type="button"
                              onclick="toggleGenericMenu(event, this)"
                            >
                              <i class="ti ti-dots"></i>
                            </button>
                          </div>

                          <div class="category-dropdown d-none">
                            <div class="dropdown-item" onclick="toggleGenericSort(this)">
                              <i class="ti ti-arrows-sort"></i><span class="sort-label">Sort A → Z</span> 
                            </div>
                            <div
                              class="dropdown-item d-flex justify-content-between"
                            >
                              <span><i class="ti ti-filter"></i> Filter</span>
                              <i class="ti ti-chevron-right"></i>
                            </div>
                            <div class="dropdown-item text-danger">
                              <i class="ti ti-eye-off"></i> Hide
                            </div>
                          </div>
                        </th>

                        <!-- Closed -->
                        <th style="position: relative" class="header-th" data-col="9">
                          <div class="d-flex align-items-center gap-1 th-label">
                            <i class="ti ti-clock me-1"></i>
                            <span>Closed</span>
                            <i class="ti ti-chevron-down header-arrow"></i>
                            <button
                              class="category-menu-btn"
                              type="button"
                              onclick="toggleGenericMenu(event, this)"
                            >
                              <i class="ti ti-dots"></i>
                            </button>
                          </div>

                          <div class="category-dropdown d-none">
                            <div class="dropdown-item" onclick="toggleGenericSort(this)">
                              <i class="ti ti-arrows-sort"></i> <span class="sort-label">Sort A → Z</span>
                            </div>
                            <div
                              class="dropdown-item d-flex justify-content-between"
                            >
                              <span><i class="ti ti-filter"></i> Filter</span>
                              <i class="ti ti-chevron-right"></i>
                            </div>
                            <div class="dropdown-item text-danger">
                              <i class="ti ti-eye-off"></i> Hide
                            </div>
                          </div>
                        </th>

                        <th><i class="ti ti-dots me-1"></i> Actions</th>
                      </tr>
                    </thead>

                    <tbody>
                      <!-- Row 1 -->
                      <tr style="border-left: 4px solid #d32f2f">
                        <td>Electrical Safety Audit</td>
                        <td>20/02/24</td>
                        <td class="text-danger fw-bold">CAT1</td>
                        <td>Building C</td>
                        <td>Main Panel</td>
                        <td>Maintenance Team</td>
                        <td>Under Review</td>
                        <td>Review</td>
                        <td>12/03/24</td>
                        <td>-</td>
                        <td>
                          <i class="ti ti-edit me-2"></i>
                          <i class="ti ti-trash"></i>
                        </td>
                      </tr>

                      <!-- Row 2 -->
                      <tr style="border-left: 4px solid #d32f2f">
                        <td>Plumbing System Review</td>
                        <td>01/03/24</td>
                        <td class="text-danger fw-bold">CAT1</td>
                        <td>Building B</td>
                        <td>Flat 301</td>
                        <td>Tenant Report</td>
                        <td>In Progress</td>
                        <td>Under Repair</td>
                        <td>18/03/24</td>
                        <td>-</td>
                        <td>
                          <i class="ti ti-edit me-2"></i>
                          <i class="ti ti-trash"></i>
                        </td>
                      </tr>

                      <!-- Row 3 -->
                      <tr style="border-left: 4px solid #f4b400">
                        <td>Fire Safety Equipment</td>
                        <td>04/09/25</td>
                        <td style="color: #d49a00; font-weight: 600">CAT2</td>
                        <td>Parmiter</td>
                        <td>Room 100</td>
                        <td>Safety Officer</td>
                        <td>Open</td>
                        <td>Pending</td>
                        <td>30/09/25</td>
                        <td>-</td>
                        <td>
                          <i class="ti ti-edit me-2"></i>
                          <i class="ti ti-trash"></i>
                        </td>
                      </tr>

                      <!-- Row 4 -->
                      <tr style="border-left: 4px solid #4caf50">
                        <td>Generator Testing</td>
                        <td>08/03/24</td>
                        <td style="color: #2e7d32; font-weight: 600">CAT3</td>
                        <td>Building D</td>
                        <td>Generator Room</td>
                        <td>Scheduled Maintenance</td>
                        <td>Completed</td>
                        <td>Closed</td>
                        <td>10/03/24</td>
                        <td>10/03/24</td>
                        <td>
                          <i class="ti ti-edit me-2"></i>
                          <i class="ti ti-trash"></i>
                        </td>
                      </tr>

                      <!-- Row 5 -->
                      <tr style="border-left: 4px solid #f4b400">
                        <td>Fire Safety Equipment</td>
                        <td>10/03/24</td>
                        <td class="text-danger fw-bold">CAT1</td>
                        <td>Building A</td>
                        <td>Flat 203</td>
                        <td>Safety Officer</td>
                        <td>Open</td>
                        <td>Pending</td>
                        <td>25/03/24</td>
                        <td>-</td>
                        <td>
                          <i class="ti ti-edit me-2"></i>
                          <i class="ti ti-trash"></i>
                        </td>
                      </tr>

                      <!-- Row 6 -->
                      <tr style="border-left: 4px solid #f4b400">
                        <td>Fire Safety Equipment</td>
                        <td>12/03/24</td>
                        <td class="text-danger fw-bold">CAT1</td>
                        <td>Building A</td>
                        <td>Flat 303</td>
                        <td>Safety Officer</td>
                        <td>Open</td>
                        <td>Pending</td>
                        <td>25/03/24</td>
                        <td>-</td>
                        <td>
                          <i class="ti ti-edit me-2"></i>
                          <i class="ti ti-trash"></i>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <div id="boardView" style="display: none">
            <div class="row g-4">
              <!-- OPEN -->
              <div class="col-md-3">
                <!-- HEADER ONLY (colored) -->
                <div class="kanban-header-box" style="background: #f6f7f9">
                  <span>Open</span>
                  <span class="kanban-count">1</span>
                </div>

                <!-- WHITE CARDS AREA -->
                <div class="kanban-column">
                  <div class="kanban-card-container">
                    <div class="d-flex justify-content-between">
                      <h6 class="fw-semibold">Fire Safety Equipment</h6>
                      <div>
                        <i class="ti ti-edit me-2"></i>
                        <i class="ti ti-trash"></i>
                      </div>
                    </div>

                    <span class="cat-pill cat2">CAT2</span>

                    <p class="small">
                      <i class="ti ti-calendar-event me-1"></i> Sep 30
                    </p>

                    <p class="small"><strong>Site:</strong> Parmiter</p>
                    <p class="small"><strong>Room:</strong> Room 100</p>
                    <p class="small mb-0">
                      <strong>Raised By:</strong> Safety Officer
                    </p>
                  </div>
                </div>
              </div>

              <!-- IN PROGRESS -->
              <div class="col-md-3">
                <!-- HEADER (colored only) -->
                <div class="kanban-header-box" style="background: #e6f0ff">
                  <span>In Progress</span>
                  <span class="kanban-count">0</span>
                </div>

                <!-- WHITE CONTENT AREA -->
                <div class="kanban-column">
                  <p class="text-center text-muted mt-5">No tasks</p>
                </div>
              </div>

              <!-- UNDER REVIEW -->
              <div class="col-md-3">
                <!-- HEADER (colored only) -->
                <div class="kanban-header-box" style="background: #f3eaff">
                  <span>Under Review</span>
                  <span class="kanban-count">1</span>
                </div>

                <!-- WHITE CONTENT AREA -->
                <div class="kanban-column">
                  <div class="kanban-card-container shadow-sm mb-3">
                    <div class="d-flex justify-content-between">
                      <h6 class="fw-semibold">Electrical Safety Audit</h6>
                      <div>
                        <i class="ti ti-edit me-2"></i>
                        <i class="ti ti-trash"></i>
                      </div>
                    </div>

                    <span class="cat-pill cat1">CAT1</span>

                    <p class="small">
                      <i class="ti ti-calendar-event me-1"></i> Mar 12
                    </p>

                    <p class="small"><strong>Site:</strong> Building C</p>
                    <p class="small"><strong>Room:</strong> Main Panel</p>
                    <p class="small mb-0">
                      <strong>Raised By:</strong> Maintenance Team
                    </p>
                  </div>
                </div>
              </div>

              <!-- COMPLETED -->
              <div class="col-md-3">
                <!-- HEADER (colored only) -->
                <div class="kanban-header-box" style="background: #e7ffe9">
                  <span>Completed</span>
                  <span class="kanban-count">1</span>
                </div>

                <!-- WHITE CARD AREA -->
                <div class="kanban-column">
                  <div class="kanban-card-container shadow-sm mb-3">
                    <div class="d-flex justify-content-between">
                      <h6 class="fw-semibold">Generator Testing</h6>
                      <div>
                        <i class="ti ti-edit me-2"></i>
                        <i class="ti ti-trash"></i>
                      </div>
                    </div>

                    <span class="cat-pill cat3">CAT3</span>

                    <p class="small">
                      <i class="ti ti-calendar-event me-1"></i> Mar 10
                    </p>

                    <p class="small"><strong>Site:</strong> Building D</p>
                    <p class="small"><strong>Room:</strong> Generator Room</p>
                    <p class="small mb-0">
                      <strong>Raised By:</strong> Scheduled Maintenance
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- DASHBOARD -->
          <div id="dashboardView" style="display: none">
            <div class="card mb-3">
              <div
                class="card-body d-flex justify-content-between align-items-center"
              >
                <div>
                  <strong>Compare Period:</strong>
                  <select class="form-select d-inline-block w-auto ms-2">
                    <option>Month-over-Month</option>
                    <option>Year-over-Year</option>
                  </select>

                  <button class="btn btn-light ms-2">
                    Nov 2025 vs Oct 2025
                  </button>
                </div>
              </div>
            </div>

            <!-- METRICS ROW -->

            <!-- DASHBOARD METRICS -->
            <div class="row g-4 mb-4">
              <!-- Total Tasks -->
              <div class="col-md-3">
                <div class="metric-card">
                  <div class="metric-top">
                    <span class="metric-number">6</span>
                    <i class="ti ti-chart-bar metric-icon text-info"></i>
                  </div>
                  <div class="metric-title">Total Tasks</div>
                  <div class="metric-previous">4 Previous</div>
                </div>
              </div>

              <!-- Completed -->
              <div class="col-md-3">
                <div class="metric-card">
                  <div class="metric-top">
                    <span class="metric-number">1</span>
                    <i class="ti ti-circle-check metric-icon text-success"></i>
                  </div>
                  <div class="metric-title">Completed</div>
                  <div class="metric-previous">0 Previous</div>
                </div>
              </div>

              <!-- In Progress -->
              <div class="col-md-3">
                <div class="metric-card">
                  <div class="metric-top">
                    <span class="metric-number">1</span>
                    <i
                      class="ti ti-trending-up metric-icon"
                      style="color: #ff8b47"
                    ></i>
                  </div>
                  <div class="metric-title">In Progress</div>
                  <div class="metric-previous">0 Previous</div>
                </div>
              </div>

              <!-- Overdue -->
              <div class="col-md-3">
                <div class="metric-card">
                  <div class="metric-top">
                    <span class="metric-number">3</span>
                    <i class="ti ti-alert-circle metric-icon text-danger"></i>
                  </div>
                  <div class="metric-title">Overdue</div>
                  <div class="metric-previous">0 Previous</div>
                </div>
              </div>
            </div>

            <!-- CHART ROW -->
            <div class="row g-3 mt-3">
              <div class="col-md-6">
                <div class="card p-4 equal-height-card">
                  <h6 class="mb-4">Priority Distribution</h6>

                  <!-- CAT1 -->
                  <div class="d-flex align-items-center mb-3">
                    <span class="dot dot-red me-2"></span>
                    <span class="me-auto">CAT1</span>

                    <div class="progress progress-custom me-3">
                      <div id="bar-cat1" class="progress-bar bar-grey"></div>
                    </div>

                    <span id="count-cat1" class="fw-bold">0</span>
                    <small id="percent-cat1" class="text-muted ms-2"
                      >(0.0%)</small
                    >
                  </div>

                  <!-- CAT2 -->
                  <div class="d-flex align-items-center mb-3">
                    <span class="dot dot-yellow me-2"></span>
                    <span class="me-auto">CAT2</span>

                    <div class="progress progress-custom me-3">
                      <div id="bar-cat2" class="progress-bar bar-grey"></div>
                    </div>

                    <span id="count-cat2" class="fw-bold">0</span>
                    <small id="percent-cat2" class="text-muted ms-2"
                      >(0.0%)</small
                    >
                  </div>

                  <!-- CAT3 -->
                  <div class="d-flex align-items-center">
                    <span class="dot dot-green me-2"></span>
                    <span class="me-auto">CAT3</span>

                    <div class="progress progress-custom me-3">
                      <div id="bar-cat3" class="progress-bar bar-grey"></div>
                    </div>

                    <span id="count-cat3" class="fw-bold">0</span>
                    <small id="percent-cat3" class="text-muted ms-2"
                      >(0.0%)</small
                    >
                  </div>
                </div>
              </div>

              <div class="col-md-6">
                <div class="card p-4 equal-height-card">
                  <h6 class="mb-4">Status Distribution</h6>

                  <!-- Open -->
                  <div class="d-flex align-items-center mb-3">
                    <span class="dot dot-gray me-2"></span>
                    <span class="me-auto">Open</span>

                    <div class="progress progress-custom me-3">
                      <div id="bar-open" class="progress-bar bar-grey"></div>
                    </div>

                    <span id="count-open" class="fw-bold">0</span>
                    <small id="percent-open" class="text-muted ms-2"
                      >(0.0%)</small
                    >
                  </div>

                  <!-- In Progress -->
                  <div class="d-flex align-items-center mb-3">
                    <span class="dot dot-blue me-2"></span>
                    <span class="me-auto">In Progress</span>

                    <div class="progress progress-custom me-3">
                      <div
                        id="bar-progress"
                        class="progress-bar bar-grey"
                      ></div>
                    </div>

                    <span id="count-progress" class="fw-bold">0</span>
                    <small id="percent-progress" class="text-muted ms-2"
                      >(0.0%)</small
                    >
                  </div>

                  <!-- Under Review -->
                  <div class="d-flex align-items-center mb-3">
                    <span class="dot dot-purple me-2"></span>
                    <span class="me-auto">Under Review</span>

                    <div class="progress progress-custom me-3">
                      <div id="bar-review" class="progress-bar bar-grey"></div>
                    </div>

                    <span id="count-review" class="fw-bold">0</span>
                    <small id="percent-review" class="text-muted ms-2"
                      >(0.0%)</small
                    >
                  </div>

                  <!-- Completed -->
                  <div class="d-flex align-items-center">
                    <span class="dot dot-green me-2"></span>
                    <span class="me-auto">Completed</span>

                    <div class="progress progress-custom me-3">
                      <div
                        id="bar-complete"
                        class="progress-bar bar-grey"
                      ></div>
                    </div>

                    <span id="count-complete" class="fw-bold">0</span>
                    <small id="percent-complete" class="text-muted ms-2"
                      >(0.0%)</small
                    >
                  </div>
                </div>
              </div>
            </div>

            <!-- BOTTOM CHARTS -->
            <div class="row g-3 mt-3">
              <div class="col-md-6">
                <div class="card p-3" style="height: 320px">
                  <h6 class="mb-3">Defects Summary</h6>

                  <div class="chart-wrapper" style="height: 240px">
                    <canvas id="defectsChart"></canvas>
                  </div>
                </div>
              </div>

              <div class="col-md-6">
                <div class="card p-4 priority-breakdown-card">
                  <h6 class="mb-0">Priority Breakdown</h6>

                  <!-- Empty Chart Area -->
                  <div class="chart-placeholder">
                    <!-- (Intentionally empty like your reference image) -->
                  </div>

                  <!-- Legend at Bottom -->
                  <div class="priority-legend">
                    <span class="legend-item">
                      <span class="legend-box red"></span> CAT1
                    </span>
                    <span class="legend-item">
                      <span class="legend-box yellow"></span> CAT2
                    </span>
                    <span class="legend-item">
                      <span class="legend-box green"></span> CAT3
                    </span>
                  </div>
                </div>
              </div>
            </div>

            <div class="card p-3 mt-3">
              <h6>Top Raised Defects</h6>
              <p class="text-center text-muted mt-4">
                No defects data available
              </p>
            </div>
          </div>

          <!-- WIDGETS VIEW -->
          <div id="widgetsview" style="display: none">
            <div class="widget-placeholder">
              <div class="widget-box">
                <div class="widget-icon">
                  <i class="ti ti-grid-dots"></i>
                </div>
                <h5 class="mt-3">Widget Dashboard</h5>
                <p>
                  Customizable widgets and dashboard components will be
                  displayed here.
                </p>
              </div>
            </div>
          </div>

          <!-- SETTINGS VIEW -->
          <div id="settingsview" style="display: none">
            <div class="widget-placeholder">
              <div class="widget-box">
                <div class="widget-icon">
                  <i class="ti ti-settings"></i>
                </div>
                <h5 class="mt-3">Module Settings</h5>
                <p>
                  Configuration options and module settings will be displayed
                  here.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- /Page Wrapper -->
    </div>
    <!-- /Main Wrapper -->

    <!-- JS Files -->
    <script src="../assets/js/jquery-3.7.1.min.js"></script>
    <script src="../assets/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/script.js"></script>

    <script>
      // Show current time live
      setInterval(() => {
        document.getElementById("current-time").innerHTML =
          new Date().toLocaleTimeString();
      }, 1000);
    </script>
    <script>
      $(document).ready(function () {
        $("#toggle_btn").on("click", function () {
          if ($("body").hasClass("mini-sidebar")) {
            $("body").removeClass("mini-sidebar");
            $(".sidebar").css("width", "260px");
          } else {
            $("body").addClass("mini-sidebar");
            $(".sidebar").css("width", "60px");
          }
        });
      });
    </script>

    <script>
      document.querySelectorAll("#taskTabs .nav-link").forEach((tab) => {
        tab.addEventListener("click", function (e) {
          e.preventDefault();

          // Remove active class from all tabs
          document
            .querySelectorAll("#taskTabs .nav-link")
            .forEach((t) => t.classList.remove("active"));

          // Add active to clicked tab
          this.classList.add("active");

          const view = this.getAttribute("data-view");

          // Toggle views
          document.getElementById("tableView").style.display =
            view === "table" ? "block" : "none";
          document.getElementById("boardView").style.display =
            view === "board" ? "block" : "none";
        });
      });
    </script>

    <script>
      document.querySelectorAll("#taskTabs .nav-link").forEach((tab) => {
        tab.addEventListener("click", function () {
          // Remove active state
          document
            .querySelectorAll("#taskTabs .nav-link")
            .forEach((t) => t.classList.remove("active"));
          this.classList.add("active");

          let view = this.getAttribute("data-view");

          // Hide all views
          document.getElementById("tableView").style.display = "none";
          document.getElementById("boardView").style.display = "none";
          document.getElementById("dashboardView").style.display = "none";
          document.getElementById("widgetsview").style.display = "none";

          if (view === "table") {
            document.getElementById("tableView").style.display = "block";
          }
          if (view === "board") {
            document.getElementById("boardView").style.display = "block";
          }
          if (view === "dashboard") {
            document.getElementById("dashboardView").style.display = "block";
          }
        });
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const rows = document.querySelectorAll("tbody tr");

        let cat1 = 0,
          cat2 = 0,
          cat3 = 0;

        rows.forEach((row) => {
          const category = row.children[2].innerText.trim(); // Category column index = 2

          if (category === "CAT1") cat1++;
          if (category === "CAT2") cat2++;
          if (category === "CAT3") cat3++;
        });

        const total = cat1 + cat2 + cat3;

        const percent1 = total ? ((cat1 / total) * 100).toFixed(1) : 0;
        const percent2 = total ? ((cat2 / total) * 100).toFixed(1) : 0;
        const percent3 = total ? ((cat3 / total) * 100).toFixed(1) : 0;

        // Update numbers
        document.getElementById("count-cat1").innerText = cat1;
        document.getElementById("count-cat2").innerText = cat2;
        document.getElementById("count-cat3").innerText = cat3;

        document.getElementById("percent-cat1").innerText = `(${percent1}%)`;
        document.getElementById("percent-cat2").innerText = `(${percent2}%)`;
        document.getElementById("percent-cat3").innerText = `(${percent3}%)`;

        // Update bars
        document.getElementById("bar-cat1").style.width = percent1 + "%";
        document.getElementById("bar-cat2").style.width = percent2 + "%";
        document.getElementById("bar-cat3").style.width = percent3 + "%";
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const rows = document.querySelectorAll("tbody tr");

        let open = 0,
          progress = 0,
          review = 0,
          complete = 0;

        rows.forEach((row) => {
          const status = row.children[6].innerText.trim(); // Status column

          if (status === "Open") open++;
          if (status === "In Progress") progress++;
          if (status === "Under Review") review++;
          if (status === "Completed") complete++;
        });

        const total = open + progress + review + complete;

        const pOpen = total ? ((open / total) * 100).toFixed(1) : 0;
        const pProgress = total ? ((progress / total) * 100).toFixed(1) : 0;
        const pReview = total ? ((review / total) * 100).toFixed(1) : 0;
        const pComplete = total ? ((complete / total) * 100).toFixed(1) : 0;

        // Numbers
        document.getElementById("count-open").innerText = open;
        document.getElementById("count-progress").innerText = progress;
        document.getElementById("count-review").innerText = review;
        document.getElementById("count-complete").innerText = complete;

        // Percentages
        document.getElementById("percent-open").innerText = `(${pOpen}%)`;
        document.getElementById(
          "percent-progress"
        ).innerText = `(${pProgress}%)`;
        document.getElementById("percent-review").innerText = `(${pReview}%)`;
        document.getElementById(
          "percent-complete"
        ).innerText = `(${pComplete}%)`;

        // Bars
        document.getElementById("bar-open").style.width = pOpen + "%";
        document.getElementById("bar-progress").style.width = pProgress + "%";
        document.getElementById("bar-review").style.width = pReview + "%";
        document.getElementById("bar-complete").style.width = pComplete + "%";
      });
    </script>

    <script>
      document
        .querySelector('[data-view="widgets"]')
        .addEventListener("click", function (e) {
          e.preventDefault();

          // Hide existing working views (same as your pattern)
          document.getElementById("tableView").style.display = "none";
          document.getElementById("boardView").style.display = "none";
          document.getElementById("dashboardView").style.display = "none";
          document.getElementById("settingsview").style.display = "none";

          // Show ONLY widgets
          document.getElementById("widgetsview").style.display = "block";

          // Active tab highlight
          document
            .querySelectorAll("#taskTabs .nav-link")
            .forEach((t) => t.classList.remove("active"));
          this.classList.add("active");
        });
    </script>

    <script>
      document
        .querySelector('[data-view="settings"]')
        .addEventListener("click", function (e) {
          e.preventDefault();

          // Hide other working views
          document.getElementById("tableView").style.display = "none";
          document.getElementById("boardView").style.display = "none";
          document.getElementById("dashboardView").style.display = "none";
          document.getElementById("widgetsview").style.display = "none";

          // Show SETTINGS
          document.getElementById("settingsview").style.display = "block";

          // Active tab highlight
          document
            .querySelectorAll("#taskTabs .nav-link")
            .forEach((t) => t.classList.remove("active"));
          this.classList.add("active");
        });
    </script>

    <script>
      function toggleGenericMenu(event, btn) {
        event.stopPropagation();

        // Close ALL dropdowns first
        document.querySelectorAll(".category-dropdown").forEach((menu) => {
          menu.classList.add("d-none");
        });

        // Toggle only this one
        const dropdown = btn.closest("th").querySelector(".category-dropdown");
        dropdown.classList.toggle("d-none");
      }

      // Close everything on outside click
      document.addEventListener("click", function () {
        document.querySelectorAll(".category-dropdown").forEach((menu) => {
          menu.classList.add("d-none");
        });
      });
    </script>

    <script>
  let genericSortState = {}; // keeps state per column

  function toggleGenericSort(el) {
    const th = el.closest("th");
    const colIndex = Number(th.dataset.col);
    if (Number.isNaN(colIndex)) return;

    const table = document.querySelector("table");
    const tbody = table.querySelector("tbody");
    const rows = Array.from(tbody.querySelectorAll("tr"));

    // ✅ init only once
    if (!(colIndex in genericSortState)) {
      genericSortState[colIndex] = true; // first time: A → Z
    }
    const isAZ = genericSortState[colIndex];

    rows.sort((a, b) => {
      let A = a.children[colIndex].innerText.trim();
      let B = b.children[colIndex].innerText.trim();

      // Try date sort first
      if (!isNaN(Date.parse(A)) && !isNaN(Date.parse(B))) {
        return isAZ ? new Date(A) - new Date(B) : new Date(B) - new Date(A);
      }

      A = A.toUpperCase();
      B = B.toUpperCase();
      return isAZ ? A.localeCompare(B) : B.localeCompare(A);
    });

    rows.forEach(row => tbody.appendChild(row));

    // Update label text
    const label = el.querySelector(".sort-label");
    if (label) {
      label.innerText = isAZ ? "Sort Z → A" : "Sort A → Z";
    }

    // ✅ flip state for next click
    genericSortState[colIndex] = !isAZ;

    const dropdown = th.querySelector(".category-dropdown");
    if (dropdown) dropdown.classList.add("d-none");
  }
</script>


    <script>
      function hideGenericColumn(el) {
        const th = el.closest("th");
        const colIndex = parseInt(th.dataset.col);
        const table = document.querySelector("table");

        // Hide header
        th.style.display = "none";

        // Hide column cells
        table.querySelectorAll("tbody tr").forEach((row) => {
          row.children[colIndex].style.display = "none";
        });
      }
    </script>

    <script>
      let isCategorySortedAZ = true; // default state

      function toggleCategorySort() {
        const table = document.querySelector("table");
        const tbody = table.querySelector("tbody");
        const rows = Array.from(tbody.querySelectorAll("tr"));

        rows.sort((a, b) => {
          const catA = a.children[2].innerText.trim().toUpperCase(); // Category column
          const catB = b.children[2].innerText.trim().toUpperCase();

          return isCategorySortedAZ
            ? catA.localeCompare(catB) // A → Z
            : catB.localeCompare(catA); // Z → A
        });

        // Re-append rows
        rows.forEach((row) => tbody.appendChild(row));

        // Toggle label text
        const label = document.getElementById("sortLabel");
        label.innerText = isCategorySortedAZ ? "Sort Z → A" : "Sort A → Z";

        // Flip state
        isCategorySortedAZ = !isCategorySortedAZ;

        // Close dropdown
        document.getElementById("categoryDropdown").classList.add("d-none");
      }
    </script>
    <script>
      function toggleCategoryMenu(event) {
        event.stopPropagation();
        const dropdown = document.getElementById("categoryDropdown");
        dropdown.classList.toggle("d-none");
      }

      // Close menu when clicking outside
      document.addEventListener("click", function () {
        const dd = document.getElementById("categoryDropdown");
        if (dd && !dd.classList.contains("d-none")) {
          dd.classList.add("d-none");
        }
      });
    </script>
  </body>
</html>
